# keeper

- 基于 Raft 算法定义的分布式的自动运维脚本管理工具，可用于维护类似于galera集群这类分布式系统，可根据所有节点信息在所有节点进行维护。
- 支持最小两个节点的集群部署，实现Raft算法定义的超时选举避免最小两节点的选举问题。

### 运行环境

1. 因为目前大多数生产环境使用的Linux自带的python版本还是2.7，第一个版本还是基于python2.7开发。

### SRkv

1. 使用 zerorpc 对外暴露和节点选举以及存取键值对有关的方法。
2. 使用 gevent 生成集群角色维护的事件循环和数据事务执行的事件循环（还包括一个 zerorpc 自己的事件循环）。
3. 因为 zerorpc 原生不支持使用 kwargs 形参，并且是明文传输，增加对传参和返回的修饰。

### manager

1. 从配置文件读取需要运行的子进程的配置（keeper-procs)。
2. 从工作目录下导入需要运行的模块或脚本，并生成子进程运行该脚本的 proc 方法。
3. 根据脚本配置的 require 参数决定脚本的加载顺序，根据 reload_max 参数决定在脚本运行失败后的重启次数。
4. SRkv 为默认运行模块。
